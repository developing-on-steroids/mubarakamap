<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins&display=swap');

        #body {
            font-family: 'Poppins', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 50px;
        }

        body::-webkit-scrollbar {
            display: none;
        }

        /* Hide scrollbar for IE, Edge and Firefox */
        body {
            -ms-overflow-style: none;
            /* IE and Edge */
            scrollbar-width: none;
            /* Firefox */
        }

        .close {
            position: absolute;
            top: 40px;
            left: 50px;
            height: 40px;
            width: 40px;
            z-index: 20;
            cursor: pointer;
            font-size: 2.5rem;
        }


        .svg-container {
            width: 100%;
            height: 100%;
            overflow: scroll;
            position: relative;
        }

        .svg-container::-webkit-scrollbar {
            display: none;
        }

        /* Hide scrollbar for IE, Edge and Firefox */
        .svg-container {
            -ms-overflow-style: none;
            /* IE and Edge */
            scrollbar-width: none;
            /* Firefox */
        }

        svg {
            border: 1px solid #ddd;
            position: absolute;
            width: 1994px;
            height: 1282.74px;
        }

        .whole_back {
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .point {
            fill: #f7a930;
            cursor: pointer;
            stroke-width: 15;
            stroke: transparent;
        }

        text,
        rect {
            cursor: pointer;
        }

        .sl {
            color: white;
        }

        #contMain {
            width: 100vw;
            height: 90vh;
            /* min-height: 700px; */
            display: grid;
            grid-template-rows: 1fr;
            grid-template-columns: 70% 30%;
        }

        #infoBox {
            display: flex;
            flex-direction: column;
            justify-content: start;
            margin-top: 20%;
            padding: 0 10%;
        }

        #infoBox * {
            margin: 0;
            padding: 0;
        }

        #infoBox h1 {
            font-size: 2.5rem;
            font-weight: bolder;
            color: #2eb74c;
            margin: 0;
            margin-bottom: 10px;
        }

        #infoBox h1,
        #infoBox p {
            padding: 0 12%;
        }

        #infoBox p {
            font-size: 1.1rem;
            margin-bottom: 30px;
        }

        #boxIn {
            border-left: 45px solid #e36e42;
            border-right: 45px solid #e36e42;
            border-width: 0 20%;
        }


        #airline_info {
            display: grid;
            grid-template-columns: 0.3fr 1.7fr;
            grid-template-rows: 1fr;
            border-bottom: 2px solid #dfdfdf;
            padding: 15px 10%;
            align-items: center;
            justify-items: center;
        }

        #instruction {
            border-top: 2px solid #dfdfdf;
            font-size: 2rem;
            color: #e36e42;
            text-align: center;
            padding-top: 10px;
        }

        #instruction2 {
            font-size: 1.3rem;
            color: #414966;
            text-align: center;
            margin-top: 5px;
        }

        #instruction3 {
            text-align: center;
        }

        .airline_logo {
            width: 70px;
            border-radius: 100%;
        }

        @media only screen and (max-width: 1300px) {
            #body {
                margin: 20px;
            }

            #instruction3 {
                font-size: 1.3rem;
            }

            #instruction2 {
                font-size: 1rem;
            }

            #instruction {
                font-size: 1.7rem;
            }
        }

        @media only screen and (max-width: 1200px) {

            #contMain {
                grid-template-rows: 70% 30%;
                grid-template-columns: 1fr;
                /* padding: 0 50px; */
                width: auto;
            }

            #svgCanvas {
                transform: scale(0.9);
            }

            #boxIn {
                margin: 0 5%;
            }

            #infoBox {
                margin-top: 55px;
                padding: 0%;
                flex-direction: row;
                display: grid;
                grid-template-columns: 1fr 0.1fr 1fr;
                grid-template-rows: 1fr 1fr;
                align-items: center;
                gap: 0px 0px;
                grid-auto-flow: row;
                grid-template-areas:
                    "inh inh boxIn"
                    "inp inp boxIn";
            }

            #inh {
                grid-area: inh;
                align-items: end;
                display: grid;
                height: 100%;
            }

            #infoBox h1 {
                font-size: 2rem;
            }

            #inp {
                grid-area: inp;
            }

            #boxIn {
                grid-area: boxIn;
            }


        }

        @media only screen and (max-width: 700px) {
            #infoBox {
                display: flex;
                flex-direction: column;
                margin-top: 30px;
            }

            #contMain {
                grid-template-rows: 60% 40%;
            }

            #BoxIn {
                padding: 0;
            }

        }

        @media only screen and (min-width: 3000px) {

            #infoBox {
                margin-top: 50%;
            }

            #instruction3 {
                font-size: 3.5rem;
            }

            #instruction2 {
                font-size: 3.5rem;
            }

            #instruction {
                font-size: 4rem;
            }

            #infoBox h1 {
                font-size: 4.5rem;
                margin-bottom: 20px;
            }

            #infoBox p {
                font-size: 2.5rem;
                margin-bottom: 50px;
            }
        }
    </style>
    <title>SVG Line Generator</title>
</head>

<body>

    <section id="body">
        <p class="close" onclick="removePreviousLine(), clearName()">&#128260;</p>
        <div id="contMain">
            <div class="svg-container" id="svgContainer">
                <svg id="svgCanvas" onclick="getPointCoordinates2(event)">
                    <image class="whole_back" href="world-map-sl-marking 1.png" width="1994" height="1282.72" />
                    <!-- Image at the fixed point (206, 207) -->
                    <!-- <image xlink:href="https://cdn.pixabay.com/photo/2013/07/12/17/00/location-151669_1280.png" x="190"
                        y="177" width="32" height="32" /> -->
                    <circle class="point" cx="999.39" cy="581.6" r="5" data-name="London" data-duration="4 Hours"
                        data-airline="Adnan Airways" data-connection=false id="london"
                        onclick="getPointCoordinates(event)" />

                    <circle class="point" cx="597.6" cy="661.6" r="5" data-name="New York" data-duration="8 Hours <br> 4 hours 30 mins"
                        data-airline="Murtaza Jetways" data-connection=true data-connecting="marrakech" id="newYork"
                        onclick="getPointCoordinates(event)" />

                    <circle class="point" cx="1017.6" cy="586.4" r="5" data-name="Brussels" data-duration="6 Hours"
                        data-airline="Karyana Airlines" data-connection=false id="brussels"
                        onclick="getPointCoordinates(event)" />

                    <circle class="point" cx="959.6" cy="730.6" r="5" data-name="Marrakech" data-duration="8 Hours"
                        data-airline="Jet Mubarak" data-connection=false id="marrakech"
                        onclick="getPointCoordinates(event)" />

                    <circle class="point" cx="1158.4" cy="664.6" r="5" data-name="Istanbul" data-duration="2 Hours"
                        data-airline="Emirates" data-connection=false id="istanbul"
                        onclick="getPointCoordinates(event)" />

                    <circle class="point" cx="903.6" cy="831.39" r="5" data-name="Dakar" data-duration="2 Hours"
                        data-airline="Mubaraka Airways" data-connection=false id="dakar"
                        onclick="getPointCoordinates(event)" />

                    <circle class="point" cx="1209" cy="882.6" r="5" data-name="Addis Ababa" data-duration="8 Hours"
                        data-airline="Air Adnan" data-connection=false id="addisAbaba"
                        onclick="getPointCoordinates(event)" />

                    <circle class="point" cx="1192" cy="922.4" r="5" data-name="Nairobi" data-duration="2 Hours"
                        data-airline="Design Air" data-connection=false id="nairobi"
                        onclick="getPointCoordinates(event)" />

                    <circle class="point" cx="1004.4" cy="876.6" r="5" data-name="Lome" data-duration="2 Hours"
                        data-airline="Emirates7" data-connection=false id="lome" onclick="getPointCoordinates(event)" />

                    <!-- Background rectangles for each text element with rounded corners -->
                    <rect x="913.39" y="547" width="80" height="30" rx="5" ry="5" fill="#fdee00"
                        onclick="clickIt('london')" />
                    <rect x="607.6" y="651.6" width="95" height="30" rx="5" ry="5" fill="#fdee00"
                        onclick="clickIt('newYork')" />
                    <rect x="1027.6" y="556.4" width="80" height="30" rx="5" ry="5" fill="#fdee00"
                        onclick="clickIt('brussels')" />
                    <rect x="854.6" y="698.2" width="95" height="30" rx="5" ry="5" fill="#fdee00"
                        onclick="clickIt('marrakech')" />
                    <rect x="1164.4" y="630.6" width="80" height="30" rx="5" ry="5" fill="#fdee00"
                        onclick="clickIt('istanbul')" />
                    <rect x="823.6" y="801.39" width="70" height="30" rx="5" ry="5" fill="#fdee00"
                        onclick="clickIt('dakar')" />
                    <rect x="1219" y="846.6" width="120" height="30" rx="5" ry="5" fill="#fdee00"
                        onclick="clickIt('addisAbaba')" />
                    <rect x="1112" y="886.4" width="80" height="30" rx="5" ry="5" fill="#fdee00"
                        onclick="clickIt('nairobi')" />
                    <rect x="1009.4" y="838.6" width="70" height="30" rx="5" ry="5" fill="#fdee00"
                        onclick="clickIt('lome')" />

                    <!-- sierraLeoneRect -->
                    <rect x="795" y="853.39" width="120" height="30" rx="5" ry="5" fill="#66b5ef"
                        id="sierraLeoneRect" />

                    <!-- Text elements -->
                    <text x="923.39" y="567" class="point-label" onclick="clickIt('london')">London</text>
                    <text x="618.6" y="671.6" class="point-label" onclick="clickIt('newYork')">New York</text>
                    <text x="1035.6" y="577.4" class="point-label" onclick="clickIt('brussels')">Brussels</text>
                    <text x="860.6" y="718.2" class="point-label" onclick="clickIt('marrakech')">Marrakech</text>
                    <text x="1172.4" y="650.6" class="point-label" onclick="clickIt('istanbul')">Istanbul</text>
                    <text x="836.6" y="821.39" class="point-label" onclick="clickIt('dakar')">Dakar</text>
                    <text x="1229" y="866.6" class="point-label" onclick="clickIt('addisAbaba')">Addis Ababa</text>
                    <text x="1122" y="906.4" class="point-label" onclick="clickIt('nairobi')">Nairobi</text>
                    <text x="1022.4" y="858.6" class="point-label" onclick="clickIt('lome')">Lome</text>

                    <!-- sierraLeoneText -->
                    <text x="806" y="873.39" class="point-label sl" fill="#ffffff">Sierra Leone</text>


                </svg>
            </div>

            <div id="infoBox">
                <h1 id="inh">FLIGHTS</h1>
                <p id="inp">With daily flights from many cities across the World, travel to Sierra Leone is easier than
                    you
                    would
                    imagine</p>

                <div id="boxIn">
                    <h2 id="instruction">DEPARTURE</h2>
                    <h2 id="instruction2">FLIGHT DURATION</h2>
                    <div id="airline_info">
                        <img src="Mubaraka Airways.jpg" alt="airline-logo" class="airline_logo" id="instruction4">
                        <h2 id="instruction3">Airlines Name</h2>
                    </div>
                </div>
            </div>

        </div>

    </section>

    <script>
        const svgContainer = document.getElementById('svgContainer');
        let isDown = false;
        let startX;
        let startY;
        let scrollLeft;
        let scrollTop;
        let rerun = false;

        document.addEventListener('DOMContentLoaded', () => {

            var imageElement = document.querySelector('#svgCanvas');

            var baseWidth = 1994;
            var baseHeight = 1282.72;

            var viewportWidth = window.innerWidth;
            var viewportHeight = window.innerHeight;

            // customize initial map view position (adjust these values as needed)
            svgContainer.scrollLeft = 465; // Example: horizontal scroll position
            svgContainer.scrollTop = 420; // Example: vertical scroll position

            if (viewportWidth >= 3300 && viewportHeight >= 2100) {
                imageElement.setAttribute('transform', 'scale(2)');
            }

            if (viewportWidth <= 1200) {
                // customize initial map view position (adjust these values as needed)
                svgContainer.scrollLeft = 580; // Example: horizontal scroll position
                svgContainer.scrollTop = 520; // Example: vertical scroll position

            }

            if (viewportWidth <= 700) {
                // customize initial map view position (adjust these values as needed)
                svgContainer.scrollLeft = 660; // Example: horizontal scroll position
                svgContainer.scrollTop = 520; // Example: vertical scroll position

            }
        });

        addEventListener("resize", (event) => {
            var imageElement = document.querySelector('#svgCanvas');

            var baseWidth = 1994;
            var baseHeight = 1282.72;

            var viewportWidth = window.innerWidth;
            var viewportHeight = window.innerHeight;

            if (viewportWidth >= 3300 && viewportHeight >= 2100) {
                imageElement.setAttribute('transform', 'scale(2)');
            }

            if (viewportWidth <= 2000 && viewportHeight <= 1000) {
                imageElement.setAttribute('transform', 'scale(1)');
                svgContainer.scrollLeft = 465;
                svgContainer.scrollTop = 420;
            }
            if (viewportWidth <= 1200) {
                // customize initial map view position (adjust these values as needed)
                svgContainer.scrollLeft = 580; // Example: horizontal scroll position
                svgContainer.scrollTop = 520; // Example: vertical scroll position

            }
        });

        //prevents scrolling in the map

        // svgContainer.addEventListener('wheel', function (event) {
        //     event.preventDefault();
        // });

        svgContainer.addEventListener('mousedown', (e) => {
            isDown = true;
            startX = e.pageX - svgContainer.offsetLeft;
            startY = e.pageY - svgContainer.offsetTop;
            scrollLeft = svgContainer.scrollLeft;
            scrollTop = svgContainer.scrollTop;
            svgContainer.style.cursor = 'grabbing';
        });

        svgContainer.addEventListener('mouseleave', () => {
            isDown = false;
            svgContainer.style.cursor = 'grab';
        });

        svgContainer.addEventListener('mouseup', () => {
            isDown = false;
            svgContainer.style.cursor = 'grab';
        });

        document.addEventListener('mousemove', (e) => {
            if (!isDown) return;
            e.preventDefault();
            const x = e.pageX - svgContainer.offsetLeft;
            const y = e.pageY - svgContainer.offsetTop;
            const walkX = (x - startX) * 1; // Change this number to adjust the scroll speed
            const walkY = (y - startY) * 1; // Change this number to adjust the scroll speed
            svgContainer.scrollLeft = scrollLeft - walkX;
            svgContainer.scrollTop = scrollTop - walkY;
        });

        let selectedPoint;

        function getPointCoordinates(event) {
            const clickedPoint = event.target;

            // if (clickedPoint.classList.contains("point")) {
            const x1 = parseFloat(clickedPoint.getAttribute("cx"));
            const y1 = parseFloat(clickedPoint.getAttribute("cy"));

            // Freetown Location Fixed
            const x2 = 932.7;
            const y2 = 867.4;

            if (clickedPoint.getAttribute("data-connection") == 'true') {

                rerun = true;

                const connectX = parseFloat(document.getElementById(clickedPoint.getAttribute('data-connecting'))
                    .getAttribute('cx'));
                const connectY = parseFloat(document.getElementById(clickedPoint.getAttribute('data-connecting'))
                    .getAttribute('cy'));

                //animate with connection
                animatePlaneFollowLine(x1, y1, connectX, connectY, x2, y2);


            } else if (clickedPoint.getAttribute("data-connection") == 'false') {

                rerun = false;
                // animate without connection
                animatePlaneFollowLine(x1, y1, x2, y2);

            } else {
                rerun = false;
                console.log('something went wrong');
            }

            clearName();

            // Display the name of the currently selected point
            document.getElementById("instruction").textContent =
                `${clickedPoint.getAttribute("data-name")}`.toUpperCase();
            document.getElementById("instruction2").innerHTML =
                `${clickedPoint.getAttribute("data-duration")}`.toUpperCase();
            document.getElementById("instruction3").textContent =
                `${clickedPoint.getAttribute("data-airline")}`.toUpperCase();
            document.getElementById("instruction4").setAttribute("src",
                `${clickedPoint.getAttribute("data-airline")}` + '.jpg')
            document.getElementById("instruction4").style.width = "70px";
        }

        function removePreviousLine() {
            // Remove previous line and plane
            const previousLine = document.getElementById("line");
            const previousPlane = document.getElementById("plane");
            if (previousLine) {
                svgCanvas.removeChild(previousLine);
            }
            if (previousPlane) {
                svgCanvas.removeChild(previousPlane);
            }
        }

        function clearName() {

            //clear name of last points
            document.getElementById("instruction").textContent = "DEPARTURE"
            document.getElementById("instruction2").textContent = "FLIGHT DURATION"
            document.getElementById("instruction3").textContent = "Airlines Name"
            document.getElementById("instruction4").setAttribute("src", 'Jet Mubarak.jpg')
            document.getElementById("instruction4").style.width = "0px";

        }

        // function animatePlaneFollowLine(x1, y1, x2, y2, re1, re2) {
        //     const svgCanvas = document.getElementById("svgCanvas");

        //     removePreviousLine()

        //     // Calculate control points for the Bezier curve
        //     const cx1 = x1 + (x2 - x1) * 0.25;
        //     const cy1 = y1 - 50;
        //     const cx2 = x1 + (x2 - x1) * 0.75;
        //     const cy2 = y2 - 50;

        //     // Create the path element
        //     const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        //     path.setAttribute("d", `M${x1} ${y1} C${cx1} ${cy1}, ${cx2} ${cy2}, ${x2} ${y2}`);
        //     path.setAttribute("stroke", "#f7a930");
        //     path.setAttribute("stroke-width", "2");
        //     path.setAttribute("fill", "none");
        //     path.setAttribute("stroke-dasharray", "5,5");
        //     path.setAttribute("id", "line");

        //     svgCanvas.appendChild(path);

        //     // Create the plane element
        //     const plane = document.createElementNS("http://www.w3.org/2000/svg", "image");
        //     plane.setAttribute("href", "plane.png"); // change plane image
        //     plane.setAttribute("width", "50");
        //     plane.setAttribute("height", "50");
        //     plane.setAttribute("id", "plane");

        //     svgCanvas.appendChild(plane);

        //     let distance = 0;

        //     function animate() {
        //         distance += 2; // Adjust the flight speed

        //         const point = path.getPointAtLength(distance);
        //         plane.setAttribute("x", point.x - 25);
        //         plane.setAttribute("y", point.y - 25);

        //         // Calculate the angle between the line and the x-axis
        //         const angle = Math.atan2(y2 - y1, x2 - x1) * (180 / Math.PI);
        //         plane.setAttribute("transform", `rotate(${angle} ${point.x} ${point.y})`);

        //         if (distance < path.getTotalLength() - 30) { //end the flight path earlier
        //             requestAnimationFrame(animate);
        //         }
        //     }

        //     requestAnimationFrame(animate);

        //     if (rerun == true) {
        //         rerun = false
        //         animatePlaneFollowLine(x2, y2, re1, re2);
        //     }
        // }



        function animatePlaneFollowLine(x1, y1, x2, y2, re1, re2) {

            const svgCanvas = document.getElementById("svgCanvas");

            removePreviousLine();

            // Calculate control points for the Bezier curve
            const cx1 = x1 + (x2 - x1) * 0.25;
            const cy1 = y1 - 50;
            const cx2 = x1 + (x2 - x1) * 0.75;
            const cy2 = y2 - 50;

            // Create the path element
            const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
            path.setAttribute("d", `M${x1} ${y1} C${cx1} ${cy1}, ${cx2} ${cy2}, ${x2} ${y2}`);
            path.setAttribute("stroke", "#f7a930");
            path.setAttribute("stroke-width", "2");
            path.setAttribute("fill", "none");
            path.setAttribute("stroke-dasharray", "5,5");
            path.setAttribute("id", "line");

            svgCanvas.appendChild(path);

            // Create the plane element
            const plane = document.createElementNS("http://www.w3.org/2000/svg", "image");
            plane.setAttribute("href", "plane.png"); // change plane image
            plane.setAttribute("width", "50");
            plane.setAttribute("height", "50");
            plane.setAttribute("id", "plane");

            svgCanvas.appendChild(plane);

            let distance = 0;

            function animate(callback) {
                distance += 2; // Adjust the flight speed

                const point = path.getPointAtLength(distance);
                plane.setAttribute("x", point.x - 25);
                plane.setAttribute("y", point.y - 25);

                // Calculate the angle between the line and the x-axis
                const angle = Math.atan2(y2 - y1, x2 - x1) * (180 / Math.PI);
                plane.setAttribute("transform", `rotate(${angle} ${point.x} ${point.y})`);

                if (distance < path.getTotalLength() - 30) { //end the flight path earlier
                    requestAnimationFrame(() => animate(callback));
                } else {
                    // Animation completed, execute the callback
                    if (callback) {
                        callback();
                    }
                }
            }

            animate(() => {
                // Animation is complete, run the subsequent code
                if (rerun == true) {
                    rerun = false;
                    animatePlaneFollowLine(x2, y2, re1, re2);
                }
            });
        }



        function clickIt(a) {
            var clickEvent = new Event('click');
            document.getElementById(a).dispatchEvent(clickEvent);
        }

        //When Adding new points, enable the following function to get point coordinates.
        function getPointCoordinates2(event) {
            // const svgCanvas = document.getElementById("svgCanvas");
            // const x = event.clientX - svgCanvas.getBoundingClientRect().left;
            // const y = event.clientY - svgCanvas.getBoundingClientRect().top;

            // console.log(`Clicked Point Coordinates: x = ${x}, y = ${y}`);
        }
    </script>

</body>

</html>
